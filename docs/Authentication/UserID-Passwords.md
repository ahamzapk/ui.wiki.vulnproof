---
hide:
    - footer
---

# User ID and Password Authentication

## ü™™ User ID

Following two checklists must be considered for the identifiers that can be used as a User ID.

üìù **Username Security Checklist:**

| #Ô∏è‚É£  | ‚úÖItems                                                                                                                                                                                      |                                         ‚ö†Ô∏èSeverity                                         |                         üó°Ô∏èAttacks                          |      üîóSources       |
| :-: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :----------------------------------------------------------------------------------------: | :--------------------------------------------------------: | :------------------: |
|  1  | **<ins>Verify</ins>:** Usernames are case insensitive </br> **<ins>Reason</ins>:** Prevent confusion between 'smith' and 'Smith'                                                             | <span style="background-color:#6e9642; border-radius: 3px; padding: 2px 3px; ">Low </span> | `Impersonation` <span style="opacity:0">`xxxxxxxxxx`</div> | [OWASP CS](#cs-auth) |
|  2  | **<ins>Verify</ins>:** Usernames are unique </br> **<ins>Reason</ins>:** Prevent a username to be used for multiple accounts                                                                 | <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>  |                      `Impersonation`                       | [OWASP CS](#cs-auth) |
|  3  | **<ins>Verify</ins>:** Usernames must be at least 6 characters long </br> **<ins>Reason</ins>:** Protection against guessing                                                                 | <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>  |                       `Bruteforcing`                       | [OWASP CS](#cs-auth) |
|  4  | **<ins>Verify</ins>:** Usernames are not same as some system reserved names such as root, admin, administrator etc. </br> **<ins>Reason</ins>:** Prevent user from receiving high privileges | <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>  |                      `Impersonation`                       | [OWASP CS](#cs-auth) |

üìù **Email Security Checklist:**

| #Ô∏è‚É£  | ‚úÖItems                                                                                                                                                                                                                          |                                          ‚ö†Ô∏èSeverity                                           |                       üó°Ô∏èAttacks                       |      üîóSources       |
| :-: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------------------: | :---------------------------------------------------: | :------------------: |
|  1  | **<ins>Verify</ins>:** Emails are no longer than 254 characters in length </br> **<ins>Reason</ins>:** Protection against denial of service                                                                                      | <span style="background-color:#ad8c07; border-radius: 3px; padding: 2px 3px; ">Medium </span> | `DoS` <span style="opacity:0">`xxxxxxxxxxxxxxx`</div> | [OWASP CS](#cs-auth) |
|  2  | **<ins>Verify</ins>:** Email receives a PIN for verification. The [PIN Security Checklist](#forgot-password) under [Forgot Password](#forgot-password) must be used for this </br> **<ins>Reason</ins>:** Verify user's identity |   <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   |                    `Impersonation`                    | [OWASP CS](#cs-auth) |
|  3  | **<ins>Verify</ins>:** Emails are unique </br> **<ins>Reason</ins>:** Prevent an email to be used for another account                                                                                                            |   <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   |                    `Impersonation`                    | [OWASP CS](#cs-auth) |

## üçé General Password Policies

Following items must be considered during authentication regardless of the type of protocol or authenticator being used.

üìù **Security Checklist:**

| #Ô∏è‚É£  | ‚úÖItems                                                                                                                                                                                                                                        |                                        ‚ö†Ô∏èSeverity                                         |         üó°Ô∏èAttacks          |              üîóSources              |
| :-: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---------------------------------------------------------------------------------------: | :------------------------: | :---------------------------------: |
|  1  | **<ins>Verify</ins>:** All authentication related events must be logged. Such as account lockout, account creation, account login etc. </br> **<ins>Reason</ins>:** Trigger alerts when abnormal events occur. Also, helps with investigations | <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span> |   `Insufficiant Logging`   |        [OWASP CS](#cs-auth)         |
|  2  | **<ins>Verify</ins>:** All user supplied input i.e. passwords, usernames, PINs etc., should never be trusted and must be validated </br> **<ins>Reason</ins>:** Protect against injection or Denial of Service (DOS) attacks                   | <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span> | `SQLi` `LDAPi` `XSS` `DoS` |        [OWASP CS](#cs-auth)         |
|  3  | **<ins>Verify</ins>:** TLS (HTTPS) and `Strict-Transport-Security` header is enable for every authentication process </br> **<ins>Reason</ins>:** Network traffic is encrypted which helps prevention against eavesdropping                    | <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span> |      `Eavesdropping`       | [OWASP CS](#cs-auth), [NIST](#nist) |
|  4  | **<ins>Verify</ins>:** Rate limiting mechanisms exist </br> **<ins>Reason</ins>:** Prevention against guessing and DoS                                                                                                                         | <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span> |    `Bruteforing` `DoS`     |            [NIST](#nist)            |

## üî® Password Registration

Following items must be considered for the user registration process.

üìù **Security Checklist:**

| #Ô∏è‚É£  | ‚úÖItems                                                                                                                                                                                                              |                                          ‚ö†Ô∏èSeverity                                           |                         üó°Ô∏èAttacks                          |                     üîóSources                      |
| :-: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------------------: | :--------------------------------------------------------: | :------------------------------------------------: |
|  1  | **<ins>Verify</ins>:** A password is at least 8 characters in length </br> **<ins>Reason</ins>:** Protect against guessing since shorter passwords can be guessed                                                    |   <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   | `Bruteforcing` <span style="opacity:0">`xxxxxxxxxxx`</div> |        [OWASP CS](#cs-auth), [NIST](#nist)         |
|  2  | **<ins>Verify</ins>:** A password's maximum length is at least 64 characters </br>**<ins>Reason</ins>:** Protect against password length DoS attacks                                                                 |  <span style="background-color:#6e9642; border-radius: 3px; padding: 2px 3px; ">Low </span>   |                           `DoS`                            | [OWASP CS](#cs-auth), [ASVS](#asvs), [NIST](#nist) |
|  3  | **<ins>Verify</ins>:** All ASCCI characters, unicodes and white spaces are considered valid input </br> **<ins>Reason</ins>:** Allow user to create a complex password which will make it hard to guess              | <span style="background-color:#ad8c07; border-radius: 3px; padding: 2px 3px; ">Medium </span> |                       `Bruteforcing`                       |                   [NIST](#nist)                    |
|  4  | **<ins>Verify</ins>:** Common or previously breached passwords are blocked </br>**<ins>Reason</ins>:** Protect against password guessing                                                                             | <span style="background-color:#ad8c07; border-radius: 3px; padding: 2px 3px; ">Medium </span> |                       `Bruteforcing`                       | [OWASP CS](#cs-auth), [ASVS](#asvs), [NIST](#nist) |
|  5  | **<ins>Verify</ins>:** Reuse of old passwords is not allowed </br> **<ins>Reason</ins>:** Users are likely to use the same password across many websites which can be a risk if one of those websites is compromised |  <span style="background-color:#6e9642; border-radius: 3px; padding: 2px 3px; ">Low </span>   |                       `Bruteforcing`                       |                                                    |
|  6  | **<ins>Verify</ins>:** The user is not asked to set password hints</br> **<ins>Reason</ins>:** Reveals information about the password which makes it easier to guess                                                 |   <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   |                       `Bruteforcing`                       |            [ASVS](#asvs), [NIST](#nist)            |
|  7  | **<ins>Verify</ins>:** The user is notified of an account setup via email </br> **<ins>Reason</ins>:** The user is aware of the use of their email on an external website                                            | <span style="background-color:#ad8c07; border-radius: 3px; padding: 2px 3px; ">Medium </span> |                      `Impersonation`                       |            [ASVS](#asvs), [NIST](#nist)            |

## üö¶Password Verification

Following items must be considered for password verification process

üìù **Security Checklist:**

| #Ô∏è‚É£  | ‚úÖItems                                                                                                                                                                                                                                                      |                                              ‚ö†Ô∏èSeverity                                              |                        üó°Ô∏èAttacks                        |                     üîóSources                      |
| :-: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :--------------------------------------------------------------------------------------------------: | :-----------------------------------------------------: | :------------------------------------------------: |
|  1  | **<ins>Verify</ins>:** If account lockout is in place for the provided email, authentication process should not even start </br> **<ins>Reason</ins>:** Response time delays during authentication can reveal if an account exist in the database or not     |    <span style="background-color:#ad8c07; border-radius: 3px; padding: 2px 3px; ">Medium </span>     | `Bruteforcing` <span style="opacity:0">`xxxxxxxx`</div> |                                                    |
|  2  | **<ins>Verify</ins>:** Error responses for failed login attempts are generic such as: <em>username or password is incorrect</em> </br> **<ins>Reason</ins>:** Too specific error messages can reveal information about user's account                        |    <span style="background-color:#ad8c07; border-radius: 3px; padding: 2px 3px; ">Medium </span>     |                     `Bruteforcing`                      |                [OWASP CS](#cs-auth)                |
|  3  | **<ins>Verify</ins>:** Response time for username and password checks during authentication should be the same </br> **<ins>Reason</ins>:** Difference in response time can indicate if the one of the provided credentials was found in the database or not |    <span style="background-color:#ad8c07; border-radius: 3px; padding: 2px 3px; ">Medium </span>     |                     `Bruteforcing`                      |                [OWASP CS](#cs-auth)                |
|  4  | **<ins>Verify</ins>:** HTTP status codes during authentication are generic </br> **<ins>Reason</ins>:** Too specific error messages can reveal information about user's account                                                                              | <span style="background-color:#4097c2; border-radius: 3px; padding: 2px 3px; ">Informational </span> |                     `Bruteforcing`                      |                [OWASP CS](#cs-auth)                |
|  5  | **<ins>Verify</ins>:** The `secure` flag is set for all authentication cookies </br> **<ins>Reason</ins>:** Authentication cookie value is encrypted                                                                                                         |      <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>       |                  `Eavesdropping` `XSS`                  |        [OWASP CS](#cs-auth), [NIST](#nist)         |
|  6  | **<ins>Verify</ins>:** Sensitive cookie data that is related to authentication is not being cached </br> **<ins>Reason</ins>:** Someone else can have access incase a device is left unattended or it gets stolen                                            |      <span style="background-color:#6e9642; border-radius: 3px; padding: 2px 3px; ">Low </span>      |                 `Impersonation` `Theft`                 | [OWASP CS](#cs-auth), [ASVS](#asvs), [NIST](#nist) |
|  7  | **<ins>Verify</ins>:** An account is locked after a certain number of failed attempts </br> **<ins>Reason</ins>:** Rate limiting mechanism to prevent guessing                                                                                               |      <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>       |                     `Bruteforcing`                      |        [OWASP CS](#cs-auth), [ASVS](#asvs)         |
|  8  | **<ins>Verify</ins>:** User is notified via email when an account lockout takes place </br> **<ins>Reason</ins>:** The user must be aware if someone tried to guess their account so they can change their password                                          |      <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>       |                     `Bruteforcing`                      |                                                    |
|  9  | **<ins>Verify</ins>:** Account lockout is not for a fixed time rather it should increase exponentially with each failed login attempt </br> **<ins>Reason</ins>:** Rate limiting mechanism that makes it challenging for guessing attacks to occur           |    <span style="background-color:#ad8c07; border-radius: 3px; padding: 2px 3px; ">Medium </span>     |                     `Bruteforcing`                      |        [OWASP CS](#cs-auth), [NIST](#nist)         |
| 10  | **<ins>Verify</ins>:** User is send an email notification if login occurs from a different browser, device, IP or geo location </br> **<ins>Reason</ins>:** Incase someone else logged into user's account without their consent                             |      <span style="background-color:#6e9642; border-radius: 3px; padding: 2px 3px; ">Low </span>      |                     `Impersonation`                     |                [OWASP CS](#cs-auth)                |

## üì¶ Password Storage

Following items must be implemented for password storage process

üìù **Security Checklist:**

| #Ô∏è‚É£  | ‚úÖItems                                                                                                                                                                                                                              |                                        ‚ö†Ô∏èSeverity                                         |               üó°Ô∏èAttacks                |                    üîóSources                     |
| :-: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---------------------------------------------------------------------------------------: | :------------------------------------: | :----------------------------------------------: |
|  1  | **<ins>Verify</ins>:** Passwords are hashed before storing in the database </br> **<ins>Reason</ins>:** Incase of password leak, the hashed passwords won't allow access to an account                                               | <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span> | `SQLi` `LDAPi` `Theft` `Impersonation` | [OWASP CS](#cs-ps), [ASVS](#asvs), [NIST](#nist) |
|  2  | **<ins>Verify</ins>:** Only approved hashing algorithms are used </br> **<ins>Reason</ins>:** Unapproved hashing algorithms are insecure since they can be bypassed and clear text values can be extracted                           | <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span> |             `Bruteforcing`             | [OWASP CS](#cs-ps), [ASVS](#asvs), [NIST](#nist) |
|  3  | **<ins>Verify</ins>:** A salt is used before hashing passwords </br> **<ins>Reason</ins>:** Makes passwords even more complex by adding additional characters to it. Also helps make same passwords used by multiple users different | <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span> |             `Bruteforcing`             | [OWASP CS](#cs-ps), [ASVS](#asvs), [NIST](#nist) |
|  4  | **<ins>Verify</ins>:** A salt is at least 32 bits in size </br> **<ins>Reason</ins>:** Makes it challenging to be guessed                                                                                                            | <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span> |             `Bruteforcing`             | [OWASP CS](#cs-ps), [ASVS](#asvs), [NIST](#nist) |
|  5  | **<ins>Verify</ins>:** Salt is unique for each password </br> **<ins>Reason</ins>:** When two users choose the same password, their hash won't be the same as each password is appended to a unique salt                             | <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span> |             `Bruteforcing`             | [OWASP CS](#cs-ps), [ASVS](#asvs), [NIST](#nist) |
|  6  | **<ins>Verify</ins>:** Salt is generated by using secure random algorithms </br> **<ins>Reason</ins>:** Makes is hard to predict the value of the hash                                                                               | <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span> |             `Bruteforcing`             | [OWASP CS](#cs-ps), [ASVS](#asvs), [NIST](#nist) |
|  7  | **<ins>Verify</ins>:** Peppering can be used in addition to salting </br> **<ins>Reason</ins>:** Adds additional security to the passwords. Preferred for sensitive accounts                                                         | <span style="background-color:#6e9642; border-radius: 3px; padding: 2px 3px;">Low </span> |             `Bruteforcing`             |                [OWASP CS](#cs-ps)                |
|  8  | **<ins>Verify</ins>:** If peppering is used, it is stored in a password vault </br> **<ins>Reason</ins>:** Incase of a database or codebase compromise the safe storage of peppering will help prevent password cracking             | <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span> |             `Bruteforcing`             |                [OWASP CS](#cs-ps)                |
|  9  | **<ins>Verify</ins>:** Pepper rotation policy is in place </br> **<ins>Reason</ins>:** Incase of a leak, rotation policy will force a new pepper to be used                                                                          | <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span> |         `Bruteforcing` `Theft`         |                [OWASP CS](#cs-ps)                |
| 10  | **<ins>Verify</ins>:** Pepper is produced by using secure random algorithms </br> **<ins>Reason</ins>:** Makes is challenging to predict the value                                                                                   | <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span> |             `Bruteforcing`             |                [OWASP CS](#cs-ps)                |

## üîÉ Password Reset

Following items must be implemented for password reset process.

üìù **Security Checklist:**

| #Ô∏è‚É£  | ‚úÖItems                                                                                                                                                                                                           |                                          ‚ö†Ô∏èSeverity                                           |                        üó°Ô∏èAttacks                         |              üîóSources              |
| :-: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------------------: | :------------------------------------------------------: | :---------------------------------: |
|  1  | **<ins>Verify</ins>:** User is required to reauthenticate before a password reset </br> **<ins>Reason</ins>:** Ensure that the actual user is making a change not someone else                                    |   <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   | `Impersonation` <span style="opacity:0">`xxxxxxxx`</div> | [OWASP CS](#cs-auth), [NIST](#nist) |
|  2  | **<ins>Verify</ins>:** User is required to type the new password twice </br> **<ins>Reason</ins>:** Helps prevent typing mistakes mistakes                                                                        | <span style="background-color:#ad8c07; border-radius: 3px; padding: 2px 3px; ">Medium </span> |                            ‚õî                            |            [NIST](#nist)            |
|  3  | **<ins>Verify</ins>:** Email notification is sent to this user when password change is successful </br> **<ins>Reason</ins>:** Incase user did not authorized a password change they should know someone else did | <span style="background-color:#ad8c07; border-radius: 3px; padding: 2px 3px; ">Medium </span> |                     `Impersonation`                      | [OWASP CS](#cs-auth), [NIST](#nist) |

!!! Warning "Continue ..."

     Verify that the new password must follows the [Password Registration](#password-registration) checklist

## üòï Forgot Password

When a user chooses forgot password, this can be done through multiple ways:

-   Generate a PIN which can be sent to the user with the provided email or phone number. This PIN needs to be confirmed before password reset is allowed
-   Create a token and pass it into the query string, create a limited session around that unique URL and send it to the user's email
-   Recovery/Backup codes can also be used to give access when the user can't remember their password.
-   Some application might rely on security questions for password reset

!!! Danger

    Security questions should NOT be used. If your application uses security questions, you can find a checklist to secure them [here](./MFA/Types.md#memorized-secrets)

Following items must be considered for using PINS, URL tokens or Backup Codes.

üìù **PIN Security Checklist:**

| #Ô∏è‚É£  | ‚úÖItems                                                                                                                                                                                                                                                                |                                          ‚ö†Ô∏èSeverity                                           |                        üó°Ô∏èAttacks                        |     üîóSources      |
| :-: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------------------: | :-----------------------------------------------------: | :----------------: |
|  1  | **<ins>Verify</ins>:** PIN must be 6 to 12 digits long </br> **<ins>Reason</ins>:** Protection against guessing                                                                                                                                                        |   <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   | `Bruteforcing` <span style="opacity:0">`xxxxxxxx`</div> | [OWASP CS](#cs-fp) |
|  2  | **<ins>Verify</ins>:** PIN is unique and is generated using secure random algorithms </br> **<ins>Reason</ins>:** Protection against guessing since a random value is hard to predict                                                                                  |   <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   |                     `Bruteforcing`                      | [OWASP CS](#cs-fp) |
|  3  | **<ins>Verify</ins>:** PIN must be sent to either email or phone number that the user provided </br> **<ins>Reason</ins>:** The possession of the PIN verifies their identity                                                                                          |   <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   |                     `Impersonation`                     | [OWASP CS](#cs-fp) |
|  4  | **<ins>Verify</ins>:** A limited time session is permitted for the PIN until it expires </br> **<ins>Reason</ins>:** Incase the PIN leaks through an email/phone compromise, it no longer active after a few minutes                                                   |   <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   |                 `Impersonation` `Theft`                 | [OWASP CS](#cs-fp) |
|  5  | **<ins>Verify</ins>:** Use [Password Storage](#password-storage) policies for hashing the PIN when its being stored </br> **<ins>Reason</ins>:** Helps against database compromise or PIN leakage                                                                      |   <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   |                         `Theft`                         | [OWASP CS](#cs-fp) |
|  6  | **<ins>Verify</ins>:** A generic message is shown if the email provided exists or not such as: "A PIN is sent to the provided email if it exists in the database" </br> **<ins>Reason</ins>:** Too specific error messages can reveal information about user's account | <span style="background-color:#ad8c07; border-radius: 3px; padding: 2px 3px; ">Medium </span> |                     `Bruteforcing`                      | [OWASP CS](#cs-fp) |
|  7  | **<ins>Verify</ins>:** PIN is checked for validity before the user is able to set the set a new password </br> **<ins>Reason</ins>:** Likelihood of a logic error is high when PIN validity check and password reset happens together                                  |   <span style="background-color:#6e9642; border-radius: 3px; padding: 2px 3px;">Low </span>   |              `Logic Error` `Impersonation`              | [OWASP CS](#cs-fp) |
|  8  | **<ins>Verify</ins>:** PIN in invalidated once it has been used </br> **<ins>Reason</ins>:** Prevent the reuse of the PIN                                                                                                                                              |   <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   |                 `Impersonation` `Theft`                 | [OWASP CS](#cs-fp) |

üìù **URL Token Security Checklist:**

| #Ô∏è‚É£  | ‚úÖItems                                                                                                                                                                                                                |                                          ‚ö†Ô∏èSeverity                                          |                         üó°Ô∏èAttacks                          |     üîóSources      |
| :-: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------: | :--------------------------------------------------------: | :----------------: |
|  1  | **<ins>Verify</ins>:** Token is generated using secure random algorithms </br> **<ins>Reason</ins>:** Protection against guessing since a random value is hard to predict                                              |  <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   | `Bruteforcing` <span style="opacity:0">`xxxxxxxxxxx`</div> | [OWASP CS](#cs-fp) |
|  2  | **<ins>Verify</ins>:** Use [Password Storage](#password-storage) policies for hashing the token when its being stored </br> **<ins>Reason</ins>:** Helps against database compromise or token leakage                  |  <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   |                          `Theft`                           | [OWASP CS](#cs-fp) |
|  3  | **<ins>Verify</ins>:** URL is hard-coded rather that relying on host header </br> **<ins>Reason</ins>:** Protection against host header injection                                                                      | <span style="background-color:#ad8c07; border-radius: 3px; padding: 2px 3px;">Medium </span> |                           `HHi`                            | [OWASP CS](#cs-fp) |
|  4  | **<ins>Verify</ins>:** The reset password page uses Referrer Policy tag with the `noreferrer` value </br> **<ins>Reason</ins>:** Prevention against referrer leakage                                                   | <span style="background-color:#ad8c07; border-radius: 3px; padding: 2px 3px;">Medium </span> |                     `Referrer Leakage`                     | [OWASP CS](#cs-fp) |
|  5  | **<ins>Verify</ins>:** A limited session is allowed for the URL token before it expires </br> **<ins>Reason</ins>:** Incase the token leaks through an email/phone compromise, it no longer active after a few minutes |  <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   |                  `Impersonation` `Theft`                   | [OWASP CS](#cs-fp) |
|  6  | **<ins>Verify</ins>:** Token is checked for validity before the user is able to set the set a new password </br> **<ins>Reason</ins>:** Ensure that request is coming from the intended user                           |  <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   |                      `Impersonation`                       | [OWASP CS](#cs-fp) |
|  7  | **<ins>Verify</ins>:** Token in invalidated once it has been used </br> **<ins>Reason</ins>:** Prevent the reuse of the token                                                                                          |  <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   |                  `Impersonation` `Theft`                   | [OWASP CS](#cs-fp) |

üìù **Recovery/Backup Code Security Checklist:**

Recovery/Backup code security checklist can be viewed [here](./MFA/Types.md#look-up-secrets)

!!! Warning "Continue ..."

    Once the user has been confirmed, then [Password Reset](#password-reset) checklist must be used to check functionality for the reset process

## üìú Additional Password Policies

Following items must also be considered.

üìù **Security Checklist:**

| #Ô∏è‚É£  | ‚úÖItems                                                                                                                                                                                                                         |                                          ‚ö†Ô∏èSeverity                                          |        üó°Ô∏èAttacks        |                    üîóSources                     |
| :-: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------: | :---------------------: | :----------------------------------------------: |
|  1  | **<ins>Verify</ins>:** Password expiration is in place </br> **<ins>Reason</ins>:** Incase password leaks it is no longer active forever                                                                                        | <span style="background-color:#ad8c07; border-radius: 3px; padding: 2px 3px;">Medium </span> | `Impersonation` `Theft` |       [OWASP CS](#cs-auth), [NIST](#nist)        |
|  2  | **<ins>Verify</ins>:** Application requires the user to reauthenticate for sensitive features such as payment, updating password or email etc.</br> **<ins>Reason</ins>:** Ensure that request is coming from the intended user |  <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   |     `Impersonation`     |       [OWASP CS](#cs-auth), [NIST](#nist)        |
|  3  | **<ins>Verify</ins>:** User has the option to set a second or multi factor authentication </br> **<ins>Reason</ins>:** Password leak won't impact because the second factor is still not compromised                            |  <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   | `Impersonation` `Theft` | [OWASP CS](#cs-ps), [ASVS](#asvs), [NIST](#nist) |
|  4  | **<ins>Verify</ins>:** Reauthentication takes places after a period of inactivity </br> **<ins>Reason</ins>:** Someone else cant use a user's device if it is left unattended or forgot to logout                               |  <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   |     `Impersonation`     |       [OWASP CS](#cs-auth), [NIST](#nist)        |

**üîó References:**

Open Web Application Security Project (OWASP):

-   <a href="https://github.com/OWASP/ASVS/blob/master/4.0/en/0x11-V2-Authentication.md#v2-authentication" target="_blank" id="asvs">Application Security Verification Checklist - Authentication</a>
-   <a href="https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html" target="_blank" id="cs-auth">Authentication Cheat Sheet</a>
-   <a href="https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html" target="_blank" id="cs-ps">Password Storage Cheat Sheet</a>
-   <a href="https://cheatsheetseries.owasp.org/cheatsheets/Forgot_Password_Cheat_Sheet.html" target="_blank" id="cs-fp">Forgot Password Cheat Sheet</a>
-   <a href="https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html" target="_blank" id="cs-iv">Input Validation Cheat Sheet</a>

National Institute of Standards and Technology (NIST) SP 800-63B:

-   <a href="https://pages.nist.gov/800-63-3/sp800-63b.html#-5112-memorized-secret-verifiers" target="_blank" id="nist">5.1.1.2 Memorized Secret Verifiers</a>
