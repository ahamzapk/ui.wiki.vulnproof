---
hide:
    - footer
---

# Session Management

This checklist is designed to ensure that user sessions on a website are secure. It includes a series of steps and best practices for protecting user data and preventing unauthorized access.

## üçé General Session Policies

| #Ô∏è‚É£  | ‚úÖItems                                                                                                                                                                                                         |                                          ‚ö†Ô∏èSeverity                                           |       üó°Ô∏èAttacks        |                       üîóSources                       |
| :-: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------------------: | :--------------------: | :---------------------------------------------------: |
|  1  | **<ins>Verify</ins>:** Session related events are logged such as creation, renewable, and destruction </br> **<ins>Reason</ins>:** Helps in detecting and investigating security incidences                     |   <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   | `Insufficient Logging` |             [SMCS](#SMCS), [ASVS](#ASVS)              |
|  2  | **<ins>Verify</ins>:** The session ID is never trusted and is always validated for malicious input before processing it </br> **<ins>Reason</ins>:** Protection against injection and denial of service attacks |   <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   |   `Injection`, `DoS`   |                     [SMCS](#SMCS)                     |
|  3  | **<ins>Verify</ins>:** Session ID exchange takes place over TLS (HTTPS) </br> **<ins>Reason</ins>:** Encrypted channel that prevent eavesdropping                                                               |   <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   |    `Eavesdropping`     | [SMCS](#SMCS), [ASVS](#ASVS), [SP800-63B](#SP800-63B) |
|  4  | **<ins>Verify</ins>:** Rate-limiting mechanisms exist on the session ID</br> **<ins>Reason</ins>:** Prevention against guessing and Denial of Service (DoS)                                                     | <span style="background-color:#ad8c07; border-radius: 3px; padding: 2px 3px; ">Medium </span> | `Bruteforcing`, `DoS`  |                          ‚õî                           |

## üî® Session Creation

| #Ô∏è‚É£  | ‚úÖItems                                                                                                                                                                                                                                    |                                          ‚ö†Ô∏èSeverity                                           |              üó°Ô∏èAttacks              |                       üîóSources                       |
| :-: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-------------------------------------------------------------------------------------------: | :---------------------------------: | :---------------------------------------------------: |
|  1  | **<ins>Verify</ins>:** Change the default session ID name set by the framework to a generic name as 'id' </br> **<ins>Reason</ins>:** Session ID name can disclose information about the application's framework and language being used   |  <span style="background-color:#6e9642; border-radius: 3px; padding: 2px 3px; ">Low </span>   |      `Information Disclosure`       |                     [SMCS](#SMCS)                     |
|  2  | **<ins>Verify</ins>:** The session ID must be at least 128 bits or 16 characters long </br> **<ins>Reason</ins>:** Provides enough entropy to make guessing challenging                                                                    | <span style="background-color:#ad8c07; border-radius: 3px; padding: 2px 3px; ">Medium </span> |           `Bruteforcing`            |                     [SMCS](#SMCS)                     |
|  3  | **<ins>Verify</ins>:** The session ID name is meaningless, meaning it doesn't reveal any information about the app or the user </br> **<ins>Reason</ins>:** Prevent sensitive information from leaking                                     |  <span style="background-color:#6e9642; border-radius: 3px; padding: 2px 3px; ">Low </span>   |      `Information Disclosure`       |        [SMCS](#SMCS), [SP800-63B](#SP800-63B)         |
|  4  | **<ins>Verify</ins>:** The session ID has an entropy of at least 64 bits </br> **<ins>Reason</ins>:** Minimum randomness that makes guessing challenging                                                                                   | <span style="background-color:#ad8c07; border-radius: 3px; padding: 2px 3px; ">Medium </span> |           `Bruteforcing`            | [SMCS](#SMCS), [ASVS](#ASVS), [SP800-63B](#SP800-63B) |
|  5  | **<ins>Verify</ins>:** The session ID is generated by using cryptographically secure random function </br> **<ins>Reason</ins>:** Ensure that the ID value is random and cannot be predicted                                               |   <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   | `Bruteforcing`, `Weak Cryptography` | [SMCS](#SMCS), [ASVS](#ASVS), [SP800-63B](#SP800-63B) |
|  6  | **<ins>Verify</ins>:** The session ID is unique for each user </br> **<ins>Reason</ins>:** Prevent users from accessing someone else's account                                                                                             |   <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   |           `Impersonation`           |                     [NIST](#nist)                     |
|  7  | **<ins>Verify</ins>:** The session mechanism provided by a modern framework is being used </br> **<ins>Reason</ins>:** Custom session mechanisms aren't thoroughly tested and may contain vulnerabilities                                  |   <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   |            `Custom Code`            |                     [SMCS](#SMCS)                     |
|  8  | **<ins>Verify</ins>:** If an older version of a framework is being used, ensure that session mechanism isn't vulnerable </br> **<ins>Reason</ins>:** An attacker can compromise your session by using the publicly available vulnerability |   <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   |       `Vulnerable Dependency`       |                     [SMCS](#SMCS)                     |

## üì¶ Session Storage

| #Ô∏è‚É£  | ‚úÖItems                                                                                                                                                                                                                                                                                                                                                                                                                                     |                                          ‚ö†Ô∏èSeverity                                           |                         üó°Ô∏èAttacks                          |                       üîóSources                       |
| :-: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------------------: | :--------------------------------------------------------: | :---------------------------------------------------: |
|  1  | **<ins>Verify</ins>:** `Secure` attribute is enabled for cookies </br> **<ins>Reason</ins>:** Instructs the browser to send cookies through HTTPS                                                                                                                                                                                                                                                                                           |   <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   | `Eavesdropping` <span style="opacity:0">`xxxxxxxxxx`</div> | [SMCS](#SMCS), [ASVS](#ASVS), [SP800-63B](#SP800-63B) |
|  2  | **<ins>Verify</ins>:** `HttpOnly` attribute is enabled for cookies </br> **<ins>Reason</ins>:** Instructs web browsers not to allow scripts to prevent XSS                                                                                                                                                                                                                                                                                  |   <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   |                    `Injection`, `Theft`                    | [SMCS](#SMCS), [ASVS](#ASVS), [SP800-63B](#SP800-63B) |
|  3  | **<ins>Verify</ins>:** `SameSite` attribute is enabled for cookies </br> **<ins>Reason</ins>:** Instructs web browsers to only send the cookie to the specified domain and all subdomains                                                                                                                                                                                                                                                   | <span style="background-color:#ad8c07; border-radius: 3px; padding: 2px 3px; ">Medium </span> |                           `CSRF`                           |             [SMCS](#SMCS), [ASVS](#ASVS)              |
|  4  | **<ins>Verify</ins>:** If `Domain` cookie attribute exists, ensure that the domain value is not too permissive </br> **<ins>Reason</ins>:** Ensures that cookies are only shared with the domain provided. Vulnerabilities in example.com might allow an attacker to get access to the session IDs from secure.example.com                                                                                                                  | <span style="background-color:#ad8c07; border-radius: 3px; padding: 2px 3px; ">Medium </span> |                    `Session Hijacking`                     |             [SMCS](#SMCS), [ASVS](#ASVS)              |
|  5  | **<ins>Verify</ins>:** If `Path` cookie attribute exists, ensure it is as restrictive as possible to the application that makes use of the session ID </br> **<ins>Reason</ins>:** If the path is generic such as `/`, then there's a chance that important cookie, such as session ID, will be accessible throughout the site                                                                                                              | <span style="background-color:#ad8c07; border-radius: 3px; padding: 2px 3px; ">Medium </span> |                          `Theft`                           |             [SMCS](#SMCS), [ASVS](#ASVS)              |
|  6  | **<ins>Verify</ins>:** If `Expires` and `Max-Age` attributes are used, a short expiration time is set to prevent long persistent cookies </br> **<ins>Reason</ins>:** Persistent cookies will outlive the close browser event. It is highly recommended to use non-persistent cookies for session management purposes so that the session ID does not remain on the web client cache for long periods, from where an attacker can obtain it | <span style="background-color:#ad8c07; border-radius: 3px; padding: 2px 3px; ">Medium </span> |                          `Theft`                           |             [SMCS](#SMCS), [ASVS](#ASVS)              |
|  7  | **<ins>Verify</ins>:** The session ID is not stored in local storage </br> **<ins>Reason</ins>:** Local storage is insecure as it doesn't have protection against XSS attacks, and it's value is persistent unless changed manually in code                                                                                                                                                                                                 |   <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   |                    `Injection`, `Theft`                    |                     [SMCS](#SMCS)                     |
|  8  | **<ins>Verify</ins>:** The session ID is not stored in session storage </br> **<ins>Reason</ins>:** Session storage data is persistent unless the tab or window is closed, and it is vulnerable to XSS                                                                                                                                                                                                                                      |   <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   |                    `Injection`, `Theft`                    |                     [SMCS](#SMCS)                     |
|  9  | **<ins>Verify</ins>:** Ensure that session ID is not cached in browser </br> **<ins>Reason</ins>:** If logged in device is stolen or left unattended, someone else can have access to that account                                                                                                                                                                                                                                          |  <span style="background-color:#6e9642; border-radius: 3px; padding: 2px 3px; ">Low </span>   |                          `Theft`                           |                     [SMCS](#SMCS)                     |
| 10  | **<ins>Verify</ins>:** Session data is stored server side by using secure encryption and hashing algorithms </br> **<ins>Reason</ins>:** Provides additional security incase of a database compromise                                                                                                                                                                                                                                       |   <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   |                          `Theft`                           |                     [SMCS](#SMCS)                     |

## üóëÔ∏è Session Expiration

| #Ô∏è‚É£  | ‚úÖItems                                                                                                                                                                                                                                                       |                                          ‚ö†Ô∏èSeverity                                           |               üó°Ô∏èAttacks                |                    üîóSources                     |
| :-: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------------------: | :------------------------------------: | :----------------------------------------------: |
|  1  | **<ins>Verify</ins>:** Session expires after a period of inactivity </br> **<ins>Reason</ins>:** Limits the time an attacker has to guess a session ID                                                                                                        |   <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   |          `Session Hijacking`           | [SMCS](#SMCS), [ASVS](#ASVS), [SP800-63B](#nist) |
|  2  | **<ins>Verify</ins>:** Expired session ID is no longer active </br> **<ins>Reason</ins>:** This ensures that incase an older session ID is stolen, it won't be of use                                                                                         |   <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   |          `Session Hijacking`           | [SMCS](#SMCS), [ASVS](#ASVS), [SP800-63B](#nist) |
|  3  | **<ins>Verify</ins>:** When the user clicks the logout button, the session is invalidated, and the user is asked to login </br> **<ins>Reason</ins>:** This ensures that an account is not accessible after a logout attempt                                  |   <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   |         `Unauthorized Access`          | [SMCS](#SMCS), [ASVS](#ASVS), [SP800-63B](#nist) |
|  4  | **<ins>Verify</ins>:** Allow the user to invalidate sessions on different devices </br> **<ins>Reason</ins>:** A stolen or old device doesn't give access to someone else                                                                                     | <span style="background-color:#ad8c07; border-radius: 3px; padding: 2px 3px; ">Medium </span> | `Unauthorized Access`, `Impersonation` |           [SMCS](#SMCS), [ASVS](#ASVS)           |
|  5  | **<ins>Verify</ins>:** An application should have an absolute timeout after which a user is required to login regardless of their activity/inactivity </br> **<ins>Reason</ins>:** Additional security measure to ensure that session IDs are being refreshed |  <span style="background-color:#6e9642; border-radius: 3px; padding: 2px 3px; ">Low </span>   |          `Session Hijacking`           |                  [SMCS](#SMCS)                   |
|  6  | **<ins>Verify</ins>:** Timeout functionality isn't client based </br> **<ins>Reason</ins>:** An attacker is not able to manipulate the current time and continue their session for longer than intended                                                       |  <span style="background-color:#6e9642; border-radius: 3px; padding: 2px 3px; ">Low </span>   |          `Session Hijacking`           |                  [SMCS](#SMCS)                   |
|  7  | **<ins>Verify</ins>:** Session ID renewable process exists regardless of idle timeouts </br> **<ins>Reason</ins>:** This limits the amount of time a hacker can have access to a hijacked session                                                             |  <span style="background-color:#6e9642; border-radius: 3px; padding: 2px 3px; ">Low </span>   |          `Session Hijacking`           |                  [SMCS](#SMCS)                   |

## üèóÔ∏è Session Implementation

| #Ô∏è‚É£  | ‚úÖItems                                                                                                                                                                                                                    |                                          ‚ö†Ô∏èSeverity                                           |         üó°Ô∏èAttacks         |          üîóSources           |
| :-: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------------------: | :-----------------------: | :--------------------------: |
|  1  | **<ins>Verify</ins>:** If a library is used for session management, ensure it is not misconfigured </br> **<ins>Reason</ins>:** Default configurations or misconfigurations can grant unauthorized access to an attacker   |   <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   |    `Misconfiguration`     |              ‚õî              |
|  2  | **<ins>Verify</ins>:** Libraries used for session management are not vulnerable </br> **<ins>Reason</ins>:** An attacker can use the vulnerable library to escalate their privileges                                       |   <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span>   | `Vulnerable Dependencies` |              ‚õî              |
|  3  | **<ins>Verify</ins>:** The application never reveals session ID in URL parameters or error messages </br> **<ins>Reason</ins>:** An attacker can steal this information and hijack someone's session                       | <span style="background-color:#ad8c07; border-radius: 3px; padding: 2px 3px; ">Medium </span> | `Information Disclosure`  |        [ASVS](#ASVS)         |
|  4  | **<ins>Verify</ins>:** A new session is generated when privileges change or sensitive features are performed, such as resetting passwords </br> **<ins>Reason</ins>:** Added security in case current session was hijacked | <span style="background-color:#ad8c07; border-radius: 3px; padding: 2px 3px; ">Medium </span> |      `Impersonation`      | [SMCS](#SMCS), [ASVS](#ASVS) |
|  5  | **<ins>Verify</ins>:** The user is notified when a new session is generated from a new device or location </br> **<ins>Reason</ins>:** In case an unwanted login occurs from another device or a location, the user knows  | <span style="background-color:#ad8c07; border-radius: 3px; padding: 2px 3px; ">Medium </span> |      `Impersonation`      |              ‚õî              |

## ‚öñÔ∏è Session Management

| #Ô∏è‚É£  | ‚úÖItems                                                                                                                                                                                                                                                                                    |                                        ‚ö†Ô∏èSeverity                                         |                  üó°Ô∏èAttacks                   | üîóSources |
| :-: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---------------------------------------------------------------------------------------: | :------------------------------------------: | :-------: |
|  1  | **<ins>Verify</ins>:** There's a process for invalidating sessions in the event of a security breach </br> **<ins>Reason</ins>:** Prevent an attacker from having prolonged access                                                                                                         | <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span> |             `Session Hijacking`              |    ‚õî     |
|  2  | **<ins>Verify</ins>:** Audit logs are monitored regularly for anomalies </br> **<ins>Reason</ins>:** Identify attacks that were attempted on a user's account                                                                                                                              | <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span> |             `Session Hijacking`              |    ‚õî     |
|  3  | **<ins>Verify</ins>:** Third party software or libraries used for session management are updated to the most recent version and are regularly patched </br> **<ins>Reason</ins>:** Vulnerability in a third party resource can grant an attacker unauthorized access                       | <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span> | `Session Hijacking`, `Vulnerable Dependency` |    ‚õî     |
|  4  | **<ins>Verify</ins>:** Conduct regular security assessments, vulnerability scans, and penetration testing to identify vulnerabilities in custom and third-party code </br> **<ins>Reason</ins>:** Identify any security vulnerabilities that might have appeared in session implementation | <span style="background-color:#de3a3c; border-radius: 3px; padding: 2px 3px">High </span> |             `Session Hijacking`              |    ‚õî     |

**üîó Sources:**

Open Web Application Security Project (OWASP):

-   <a href="https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V3-Session-management.md" target="_blank" id="ASVS">[ASVS] Application Security Verification Standard - Session Management</a>
-   <a href="https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html" target="_blank" id="SMCS">[SMCS] Session Management Cheat Sheet</a>

National Institute of Standards and Technology (NIST):

-   <a href="https://pages.nist.gov/800-63-3/sp800-63b.html#7-session-management" target="_blank" id="SP800-63B">[SP800-63B] 7 Session Management</a>
